# 1st Master Prompt
```
You are a senior full-stack architect, ML engineer, and UX engineer.  
Your task is to redesign and implement a complete AI-powered "University Student Spending Coach" web app.

====================================================
[UI / CODE SOURCE PROVIDED – IMPORTANT]

The project currently includes Vite+React code with the following structure:

- Dashboard.tsx
- ExpenseInput.tsx
- AIInsights.tsx
- CategoryAnalysis.tsx
- SpendingChart.tsx
- RecentTransactions.tsx
- BudgetSetting.tsx
- Settings.tsx
- ui/* (tooltip, popover, hover-card, skeleton, toggle, etc.)

These represent the Figma-generated UI components.  
You must reinterpret these as the **design blueprint** for the new system.

The redesigned UI must preserve the core layout but refactor it using:

- Next.js (App Router)
- React Server/Client Components
- TailwindCSS
- shadcn/ui design style (optional)

====================================================
[TECH STACK — MUST FOLLOW]

Frontend:
  - Next.js 14 (App Router)
  - TypeScript + TailwindCSS
  - Deploy on Vercel

Backend:
  - Node.js (Next.js server actions or API routes)
  - Supabase (PostgreSQL + Auth)
  - AI/ML Microservice:
      - Python (pandas, scikit-learn)
      - FastAPI
      - Deployed on AWS/GCP (Cloud Run recommended)

====================================================
[PRODUCT GOAL — FROM PRD]

Build an AI-powered "Spending Habit Coach" for university students.

Key modules:
1) Easy expense input (minimal steps)
2) Spending dashboard (chart, category breakdown)
3) AI insights (month-over-month, abnormal spikes, overspending detection)
4) Budget setting per category
5) Recent transactions
6) Category analysis
7) Settings

====================================================
[WHAT YOU MUST DELIVER]

Follow these steps exactly.

----------------------------------------------------
PHASE 1 — UI / UX REINTERPRETATION

1) Reconstruct the entire UI hierarchy using Next.js route structure.
   Use the provided component list as a blueprint:
   - Dashboard
   - ExpenseInput
   - AIInsights
   - CategoryAnalysis
   - SpendingChart
   - RecentTransactions
   - BudgetSetting
   - Settings
   - Common UI (popover, tooltip, alert, skeleton)

2) Create a full component architecture:
   - Page components (/dashboard, /transactions, /settings, /budget)
   - Subcomponents (Charts, Cards, InsightList, TransactionTable)
   - Modal for Add Expense (FAB-based)
   - Navigation (top or sidebar)
   - Responsive layout system

3) Produce Tailwind-friendly wireframes + React skeleton code.

----------------------------------------------------
PHASE 2 — DATABASE & SUPABASE

4) Design Supabase schema:
   - users
   - transactions
   - categories
   - budgets
   - ai_insights (generated by ML)
   - challenge (future use)
   Include types & relationships.

5) Provide SQL or Supabase migration formats.

6) Show how frontend connects to Supabase for CRUD actions using the official JS client.

----------------------------------------------------
PHASE 3 — PYTHON ML PIPELINE (FASTAPI)

7) You MUST use the CSV dataset structure similar to:
   - date
   - amount
   - description
   - category
   - payment method
   - merchant/store name

8) In pandas:
   - Load → clean → feature engineer → aggregate to user-month features.

9) Build light ML models with scikit-learn:
   - KMeans (spending personas)
   - Trend detection (month-over-month % diff)
   - Overspending risk prediction (logistic regression or baseline rules)

10) Implement and persist models (joblib).

11) Build FastAPI endpoints:
   - POST /predict/insights
   - GET /health
   - (Optional) POST /train

12) Responses should map to:
   - Insight type
   - Severity
   - Suggested action
   - Potential saving amount

----------------------------------------------------
PHASE 4 — NEXT.JS + FASTAPI INTEGRATION

13) Implement a client wrapper in Next.js to call the FastAPI service.

14) Integrate insights into the Dashboard using:
   - AIInsights component
   - CategoryAnalysis
   - SpendingChart

15) Render insights as cards (Tailwind + shadcn/ui)

----------------------------------------------------
PHASE 5 — DEPLOYMENT

16) Provide a deployment strategy:
   - Vercel for Next.js
   - AWS/GCP (Cloud Run) for FastAPI
   - Environment variables for API URLs, Supabase keys, DB URLs

----------------------------------------------------
PHASE 6 — DELIVERABLE FORMAT

17) Provide:
   - Full architecture diagram (text-based)
   - Folder structure for Next.js project
   - Code snippets (TSX, API handlers, Python scripts)
   - Explanation of each module
   - How to run both dev and prod environments
   - How to retrain the ML model with new spending data

====================================================
[STYLE]

- Think step by step
- Be explicit with reasoning
- Include code where needed
- Use correct TypeScript + Python types
- Prioritize clarity & scalability

Now begin with PHASE 1, step 1:
"Reinterpret the UI hierarchy using the provided components."

```

# 2nd 기능 추가 프롬프트
## 다크모드
```
You are a senior frontend engineer and design systems expert.

Context:
- Tech stack:
  - Next.js (App Router)
  - React
  - TypeScript
  - TailwindCSS
  - Some shadcn/ui-like primitives (tooltip, popover, card, skeleton, etc.)
- The app includes components such as:
  - Dashboard
  - ExpenseInput
  - AIInsights
  - CategoryAnalysis
  - SpendingChart
  - RecentTransactions
  - BudgetSetting
  - Settings

IMPORTANT:
- Dark mode is ALREADY PARTIALLY IMPLEMENTED.
- However, some colors are wrong or inconsistent:
  - Certain backgrounds are too bright or too dark in dark mode.
  - Some text is low-contrast or invisible on dark backgrounds.
  - Some components still use hard-coded colors (#fff, #000, etc.) instead of theme tokens.
- Your job is NOT just to add dark mode from scratch.
- Your job is to:
  1) AUDIT the existing color system and dark mode behavior,
  2) FIX broken or inconsistent colors,
  3) STABILIZE the light/dark theme so it looks polished.

====================================================
[Goals]

1) Use Tailwind `darkMode: "class"` (or confirm it is already configured correctly).
2) Build or refine a semantic color system with CSS variables, such as:
   - bg-background, bg-card, bg-muted
   - text-foreground, text-muted
   - border-border
   - accent, accent-foreground
3) Ensure both light and dark themes are:
   - Visually consistent across all pages
   - Readable (WCAG-compliant contrast, or at least reasonable)
   - Free of hard-coded, mode-breaking colors.

====================================================
[What you MUST pay special attention to]

You MUST carefully inspect and adjust:

1) Tailwind & global styles:
   - `tailwind.config.(js|ts)`
   - `globals.css` (or equivalent)
   - `index.css` or other global styles
   - Any CSS variables under :root and .dark selectors

2) Components with likely color bugs:
   - Dashboard layout (background + nested cards)
   - AIInsights (insight cards, severity badges, etc.)
   - SpendingChart (chart grid, axis labels, tooltip colors)
   - CategoryAnalysis (chips, legends, badges)
   - RecentTransactions (table rows, hover states)
   - BudgetSetting (progress bars, warnings)
   - Settings (form fields, toggles, section titles)

3) Problem patterns to find and fix:
   - Hard-coded colors like:
     - `#fff`, `#ffffff`, `#000`, `#000000`
     - direct Tailwind colors not mapped to semantic tokens (e.g., `bg-white`, `bg-black`, some `bg-slate-xxx`)
   - Inline styles that conflict with theme.
   - Components that look fine in light mode but break visually in dark mode.

====================================================
[Step-by-step tasks]

Follow these steps in order. Use “Let’s think step by step” internally.

STEP 1 — Analyze Existing Theme
- Examine tailwind.config and global CSS.
- Identify:
  - How dark mode is currently triggered (class vs media).
  - What CSS variables (if any) are defined for colors.
  - Where light/dark variants are currently set.

STEP 2 — Define or Refine Semantic Tokens
- Propose a minimal, semantic color token set, for example:
  - `--background`, `--foreground`
  - `--card`, `--card-foreground`
  - `--muted`, `--muted-foreground`
  - `--border`
  - `--accent`, `--accent-foreground`
  - `--destructive`, `--destructive-foreground`
- Define values for both `:root` (light) and `.dark` (dark).
- Ensure the palette is consistent with a modern, slightly neutral style (suitable for a finance dashboard).

STEP 3 — Tailwind Integration
- Update tailwind.config to map Tailwind utilities to the CSS variables, e.g.:
  - `background: "hsl(var(--background))"`
  - `foreground: "hsl(var(--foreground))"`
- Show the updated config snippet.

STEP 4 — Audit & Fix Components
- For each of the key components:
  - Dashboard
  - AIInsights
  - SpendingChart
  - CategoryAnalysis
  - RecentTransactions
  - BudgetSetting
  - Settings
- Do the following:
  1) Identify ANY hard-coded or suspicious color usages.
  2) Replace them with semantic classes (e.g., `bg-background`, `bg-card`, `text-muted-foreground`).
  3) Ensure hover/focus/active states have appropriate contrast in both light and dark mode.
  4) For charts and special visuals, propose a light/dark friendly color set.

- Provide concrete before/after examples when you fix a color:
  - Show the old code snippet.
  - Show the improved code snippet.
  - Explain why the new version works better in dark mode.

STEP 5 — Theme Toggle Component
- Implement a reusable `<ThemeToggle />` component that:
  - Supports "light", "dark", and "system" modes.
  - Uses `prefers-color-scheme` for system mode.
  - Persists user choice in `localStorage` (e.g., `theme = "light" | "dark" | "system"`).
  - Safely updates the `class` on `<html>` to avoid hydration issues.

- Integrate the toggle into:
  - Main layout header, and/or
  - Settings page.

STEP 6 — Visual Sanity Check & Guidelines
- Provide guidance for future components:
  - Which classes to use for surface backgrounds, cards, text, etc.
  - Example patterns:
    - Page background: `bg-background text-foreground`
    - Card: `bg-card text-card-foreground border-border`
    - Muted sections: `bg-muted text-muted-foreground`
    - Warnings: `bg-destructive/10 text-destructive border-destructive/30`
- Explain common pitfalls in dark mode and how to avoid them.

====================================================
[Output Format]

- Use clear headings for each step.
- Show updated Tailwind config.
- Show CSS variable definitions for light/dark.
- Show representative component refactors (Dashboard, AIInsights, etc.).
- Explain the reasoning behind color choices and fixes.

Be extra careful to NOT simply overwrite everything blindly.
Instead, audit → reason → fix, especially where current colors are broken or unreadable in dark mode.
```