# 1st Master Prompt
```
You are a senior full-stack architect, ML engineer, and UX engineer.  
Your task is to redesign and implement a complete AI-powered "University Student Spending Coach" web app.

====================================================
[UI / CODE SOURCE PROVIDED – IMPORTANT]

The project currently includes Vite+React code with the following structure:

- Dashboard.tsx
- ExpenseInput.tsx
- AIInsights.tsx
- CategoryAnalysis.tsx
- SpendingChart.tsx
- RecentTransactions.tsx
- BudgetSetting.tsx
- Settings.tsx
- ui/* (tooltip, popover, hover-card, skeleton, toggle, etc.)

These represent the Figma-generated UI components.  
You must reinterpret these as the **design blueprint** for the new system.

The redesigned UI must preserve the core layout but refactor it using:

- Next.js (App Router)
- React Server/Client Components
- TailwindCSS
- shadcn/ui design style (optional)

====================================================
[TECH STACK — MUST FOLLOW]

Frontend:
  - Next.js 14 (App Router)
  - TypeScript + TailwindCSS
  - Deploy on Vercel

Backend:
  - Node.js (Next.js server actions or API routes)
  - Supabase (PostgreSQL + Auth)
  - AI/ML Microservice:
      - Python (pandas, scikit-learn)
      - FastAPI
      - Deployed on AWS/GCP (Cloud Run recommended)

====================================================
[PRODUCT GOAL — FROM PRD]

Build an AI-powered "Spending Habit Coach" for university students.

Key modules:
1) Easy expense input (minimal steps)
2) Spending dashboard (chart, category breakdown)
3) AI insights (month-over-month, abnormal spikes, overspending detection)
4) Budget setting per category
5) Recent transactions
6) Category analysis
7) Settings

====================================================
[WHAT YOU MUST DELIVER]

Follow these steps exactly.

----------------------------------------------------
PHASE 1 — UI / UX REINTERPRETATION

1) Reconstruct the entire UI hierarchy using Next.js route structure.
   Use the provided component list as a blueprint:
   - Dashboard
   - ExpenseInput
   - AIInsights
   - CategoryAnalysis
   - SpendingChart
   - RecentTransactions
   - BudgetSetting
   - Settings
   - Common UI (popover, tooltip, alert, skeleton)

2) Create a full component architecture:
   - Page components (/dashboard, /transactions, /settings, /budget)
   - Subcomponents (Charts, Cards, InsightList, TransactionTable)
   - Modal for Add Expense (FAB-based)
   - Navigation (top or sidebar)
   - Responsive layout system

3) Produce Tailwind-friendly wireframes + React skeleton code.

----------------------------------------------------
PHASE 2 — DATABASE & SUPABASE

4) Design Supabase schema:
   - users
   - transactions
   - categories
   - budgets
   - ai_insights (generated by ML)
   - challenge (future use)
   Include types & relationships.

5) Provide SQL or Supabase migration formats.

6) Show how frontend connects to Supabase for CRUD actions using the official JS client.

----------------------------------------------------
PHASE 3 — PYTHON ML PIPELINE (FASTAPI)

7) You MUST use the CSV dataset structure similar to:
   - date
   - amount
   - description
   - category
   - payment method
   - merchant/store name

8) In pandas:
   - Load → clean → feature engineer → aggregate to user-month features.

9) Build light ML models with scikit-learn:
   - KMeans (spending personas)
   - Trend detection (month-over-month % diff)
   - Overspending risk prediction (logistic regression or baseline rules)

10) Implement and persist models (joblib).

11) Build FastAPI endpoints:
   - POST /predict/insights
   - GET /health
   - (Optional) POST /train

12) Responses should map to:
   - Insight type
   - Severity
   - Suggested action
   - Potential saving amount

----------------------------------------------------
PHASE 4 — NEXT.JS + FASTAPI INTEGRATION

13) Implement a client wrapper in Next.js to call the FastAPI service.

14) Integrate insights into the Dashboard using:
   - AIInsights component
   - CategoryAnalysis
   - SpendingChart

15) Render insights as cards (Tailwind + shadcn/ui)

----------------------------------------------------
PHASE 5 — DEPLOYMENT

16) Provide a deployment strategy:
   - Vercel for Next.js
   - AWS/GCP (Cloud Run) for FastAPI
   - Environment variables for API URLs, Supabase keys, DB URLs

----------------------------------------------------
PHASE 6 — DELIVERABLE FORMAT

17) Provide:
   - Full architecture diagram (text-based)
   - Folder structure for Next.js project
   - Code snippets (TSX, API handlers, Python scripts)
   - Explanation of each module
   - How to run both dev and prod environments
   - How to retrain the ML model with new spending data

====================================================
[STYLE]

- Think step by step
- Be explicit with reasoning
- Include code where needed
- Use correct TypeScript + Python types
- Prioritize clarity & scalability

Now begin with PHASE 1, step 1:
"Reinterpret the UI hierarchy using the provided components."

```